\chapter{Principy dnešního internetu věcí}
\label{ch:principy-iot}

\blind{1}

\todo{Co je to IoT a proc jej potrebujeme?}
\blind{1}

\missingfigure{Schema centralizovaneho iot systemu}

\subsection{Bezpečnost systémů}
\todo{Duraz na bezpecnost a uzivatelskou privetivost}
\blind{2}

\todo{Rozdelit na SW a HW casti}
\blind{1}

\section{Existující řešení}
\subsection{Hardware}
\todo{Pro SW poresit Loxone/SmartHome}
\blind{1}

\subsection{Software}
\todo{Pro HW poresit komercni site/pyboardy a podobne}
\blind{1}

\section{ESP32}
\todo{ESP32}
\blind{3}
\missingfigure{ESP32}

\subsection{Měření neelektrických veličin}
\todo{Co vsechno se meri - kratky uvod do HW principu mereni?}
\blind{1}

\section{MicroPython}
\todo{uPython}
MicroPython je derivátem vysokoúrovňového skriptovacího programovacího jazyka Python určený pro běh na embed zařízeních a dalších
aplikacích s nízkým výpočetním výkonem. Z hlediska vestavěné knihovny nabízí naprostou většinu základní knihovny z původní
distribuce a navíc knihovny zodpovědné za manipulaci s rozhraním mikropočítače, na kterém běží. Kromě oficiálního sestavení
pro pyboard\footnote{Oficiální (výukový) vývojový kit pro běh Micropythonu s cenou okolo \pounds30 z oficiálního e-shopu.}
nabízí komunita i sestavení pro ESP2866, ESP32, WiPy nebo Espruino Pico.


\section{Message Queuing Telemetry Transport}
Message Queuing Telemetry Transport (MQTT) je protokol definovaný ISO standardem určený pro kanálovou komunikaci zařízení
mezi sebou. Jedná se o typ komunikace klient-server nad protokolem TCP/IP, server je dle svých vlastností nazýván specificky
jako \uv{broker}. Klient má možnost si po připojení zaregistrovat odběry jednotlivých kanálů -- jejich identifikace má tvar
alfanumerických řetězců oddělených pomocí znaku \uv{/}. Benefitem přístupu s jasně definovaným oddělovačem je možnost použití zástupných znaků pro
zaregistrování odběru více kanálů zároveň. Této vlastnosti bude využito v pozdější části práce pro komunikaci s uzly. Znak \uv{+}
je použit pro zastoupení jedné úrovně kanálu, znak \uv{\#} pro víceúrovňové zahrnutí -- demonstrace těchto principů je shrnuta v
tabulce~\ref{table:02:mqtt-subscribes}.

\begin{table}
    \centering
    \begin{tabularx}{\textwidth}{ssr}
        \textbf{kanál zaregistrovaný k odběru} & \textbf{kanál zprávy} & \textbf{bude zpráva zahrnuta?} \\
        \hline
            \emph{node/1}
            &
            \emph{node/1} \newline
            \emph{node} \newline
            \emph{node/1/status} \newline
            \emph{node/2}
            &
            \truemark \newline
            \falsemark \newline
            \falsemark \newline
            \falsemark
        \\

        \hline
            \emph{node/+/status}
            &
            \emph{node/1/status} \newline
            \emph{node/2/status} \newline
            \emph{node/foo/status} \newline
            \emph{node/1/data} \newline
            \emph{node} \newline
            \emph{node/2}
            &
            \truemark \newline
            \truemark \newline
            \truemark \newline
            \falsemark \newline
            \falsemark \newline
            \falsemark
        \\

        \hline
            \emph{node/\#}
            &
            \emph{node/1} \newline
            \emph{node/2/status} \newline
            \emph{node/2/status/data} \newline
            \emph{node/} \newline
            \emph{block/}
            &
            \truemark \newline
            \truemark \newline
            \truemark \newline
            \falsemark \newline
            \falsemark
        \\

        \hline
            \emph{node/+/data/\#}
            &
            \emph{node/1/data/value} \newline
            \emph{node/2/data/value/degrees} \newline
            \emph{node/1/data/value} \newline
            \emph{node/1/status/value} \newline
            \emph{node/} \newline
            \emph{block/}
            &
            \truemark \newline
            \truemark \newline
            \truemark \newline
            \falsemark \newline
            \falsemark \newline
            \falsemark
        \\

    \end{tabularx}
    \caption{Možnosti odběru zpráv v protokolu MQTT}
    \label{table:02:mqtt-subscribes}
\end{table}
